# Шаблоны для CMake и Visual Studio Code
Набор простых шаблонов для быстрой настройки среды Visual Studio Code и CMake под контроллеры STM32


## Папка cmake

### CMakeLists.txt
Шаблон для системы CMake. Работоспособность проверялась на контроллерах семейства STM32F1 и компиляторе GNU Arm Embedded Toolchain в среде Windows.
Для настройки под свой проект необходимо отредактировать пути к файлам компилятора, программе *make*. Указать название проекта, дополнительные дефайны, папки для поиска заголовочных файлов и список самих компилируемых файлов. В файле есть комментарии по каждому пункту

Основные переменные для настройки
* `TOOLCHAIN_PREFIX` Путь к папке с компилятором, если она не просисана в переменной PATH
* `MAKE_PREFIX` Путь к папке с программой make, если она не просисана в переменной PATH
* `LINKER_SCRIPT` Путь к файлу скрипта для линковки
* `TARGET_TRIPLET` Для контроллеров используется значение "arm-none-eabi"
* `RELEASE_DIR` Имя подпапки в которой будут находится файлы для прошивки во время сборки Release.
* `DEBUG_DIR` Имя подпапки в которой будут находится файлы для прошивки во время сборки Debug
Параметры `RELEASE_DIR` и `DEBUG_DIR` можно не указывать. Тогда файлы будут компилироваться в папку из которой вызывается команда cmake

Для запуска настройки в Windows необходимо выполнить команду

    cmake -G "MinGW Makefiles" -DCMAKE_BUILD_TYPE=<Build_type> <path_to_CMakeLists.txt>
	
`<Build_type>` Тип сборки. Допустимые значения `Debug` или `Release`. По умолчанию используется сборка `Debug`
`<path_to_CMakeLists.txt>` Путь к папке, где находится файл CMakeLists.txt

### Папка cmake
Здесь находятся дополнительные файлы для общей настройки компиляции. Подключаются из файла CMakeLists.txt

## Папка vscode
Здесь находятся файлы для настройки Visual Studio Code. Содержимое папки нужно перенести в папку *.vscode* проекта и отредактировать под свои нужды.

Для работы необходимо установить дополнительные расширения
* C/C++
* CMake Tools
* Cortex-Debug

### c_cpp_properties.json
Файл для улучшения результатов IntelliSense. В нем прописываются пути для поиска заголовочный файлов и определения, которые используются при компиляции.

### settings.json
Здесь прописываются пути для настройки отладчика

### tasks.json
Файл с описанием заданий 

### cmake-kits.json
Файл с настройками добавления тулчейна для кроскомпиляции

### Папка JLink
Здесь находятся примеры скриптов для работы с отладчиком JLink. В файле *FlashMCU.jlink* необходимо изменить пути до своих двоичных файлов прошивки

# Лицензия
Все исходные материалы для проекта распространяются по лицензии [MIT](./LICENSE "Описание лицензии"). Вы можете использовать проект в любом виде, в том числе и для коммерческой деятельности, но стоит помнить, что автор проекта не дает никаких гарантий на работоспособность программы, а так же не несет никакой ответственности по искам или за нанесенный ущерб.
